<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<script type="text/javascript" src="../js/jq3.js"></script>
	<title></title>
	<link rel="stylesheet" type="text/css" href="../css/style.css">
	<script type="text/javascript">
		$(document).ready(function(){

			$("#personal").hide();
			$("#chat").hide();
			$(".listInfo").hide();
			// $(".del").hide();

			/*鼠标移到qq头像显示个人资料，移开隐藏*/
			$("#panelTop img").hover(
			function(){
				console.log("personal slideDown show")
				$("#personal").slideDown("slow",function()
					{
						$("#personal").show();
					});
			},
			function(){
				console.log("personal slideUp hide")
				$("#personal").slideUp("slow",function()
					{
						$("#personal").hide();
					});
			})

			$("#panelTop img").off("hover");

			/*点击qq头像显示个人资料*/
			$("#panelTop span").on("click",function(){
				console.log("personal show");
				$("#personal").show();
				setInterval(personalHide,10000)
			})

			function  personalHide(){
				console.log("personal hide");
				$("#personal").hide();
			}

			/*添加好友文本信息框*/
			var $input = $("input[type = 'text']");
			var addText = "";
			$(".searchText").on("keyup",function(){
				addText = $input.val();
				console.log("addText: "+addText);
				// $(".name:contains("+addText+")").css("color","red");
				// $(".listInfo").show();
			})


			/*添加好友*/
			var addTextbak="";
			$(".addBtn").on("click",function(){
				if($(".searchText").val()==="")
				{
					alert("请输入内容！");
				}
				else
				{
					console.log("add friend");					 
					var addStr=' \
					    <li>\
						<input type="checkbox"> \
						<img src="../images/head_list.jpg"> \
						<p>'+$(".searchText").val()+'</p> \
						<button>del</button> \
					</li>';
					console.log("addTextbak: "+addTextbak);
					if(addTextbak === $(".searchText").val())
					{
						alert("该帐号已添加，请重新输入");
					}
					else{
						$("#friendList ul").prepend(addStr);
				    	addTextbak = $(".searchText").val();//备份添加文本
					}
				}
			})

			/*点击分组展示好友*/
			$("#groupList").on("click","li",function(event){
				console.log("groupList ul li");
				var index = $(this).index();
            	console.log("click group index:"+index);
            	$(".listInfo").eq(index).toggle();
            	$(".listInfo").click(function(event) {
                if(event.stopPropagation) {
                    event.stopPropagation();//阻止冒泡事件发生，就是阻止点击licon时，他里面的内容也跟着运行事件。但IE并不认识
                } else if(window.event) { //IE下阻止冒泡事件，window.event.cancelBubble = true;谷歌，火狐等不认识
                    window.event.cancelBubble = true;
                }
            })
			})

			/*点击checkbox*/
			$(".listInfo ul").on("click","input",function(){
				if($(".listInfo input").is(":checked")){
					console.log("checked is true")
					//全选 反选按钮重置
					$(".allSel").prop("checked",false);
					$(".invertSel").prop("checked",false);
					// var checkIndex = $(this).index;
					// console.log("checkbox index: "+checkIndex);
					// $(".del").eq(index).show();
				}
				else
				{

				}
				/*遍历checkbox*/
				console.log("length: "+$(".listInfo input").val().length);
				$(".listInfo input").each(function(){
					var count = 0;
					for(var i=0;i<$(".listInfo input").val().length;i++)
					{
						if($(this).is(":checked")){
							count++;
						}
					}
					console.log("count: "+count);
					if(count === $(".listInfo input").val().length)
					{
						$(".allSel").prop("checked",true);
					}
					else
					{
						$(".allSel").prop("checked",false);
					}
					})
			})

			/*全选*/
			$(".allSel").on("click",function(){
				console.log("click allSel");
				if($(".allSel").is(":checked")){
					$(".listInfo input").prop("checked",true);
					$(".invertSel").prop("checked",false);
				}
				else{
					$(".listInfo input").prop("checked",false);
				}
			})

			/*反选*/
			$(".invertSel").on("click",function(){
				console.log("click invertSel");
				$(".listInfo input").each(function(){
					var state = $(this).is(":checked")?false:true;
					$(this).prop("checked",state);
				})
				if($(".allSel").is(":checked")){
                	$(".allSel").prop("checked",false); //全选按钮重置
            	}  
			})

			/*选中删除*/
			$(".delSel").on("click",function(){
				console.log("click delSel");
                $(".listInfo input").each(function(){
                    if($(this).is(":checked")){
                        $(this).parent().remove();
                    }
                })
            })

             //单条删除
	        $(".listInfo").on("click","button",function(){
	            console.log("del");
	            $(this).parent().remove();
	            $("chat").hide();
	        })

	        /*点击好友弹出聊天框*/
	        $(".listInfo").on("click","p",function(){	      
	        	
	            var textstr =$(this).text();
	            console.log("click name:"+textstr);
            	$("#chatTop p").text(textstr);
            	$("#receive span").text(textstr);
            	$(".sender").html("");//共用div，不同昵称，弹框之前要先之前发送信息清空
           		$("#chat").show();           	
	        })

	        /*点击close关闭聊天框*/
	        $("#chatTop").on("click","button",function(){
	        	console.log("close chat");
	        	$("#chat").fadeIn("slow",function(){
	        		$("#chat").hide();
	        	})
	        })

	        /*发送*/
	        $("#chatSend").on("click","button",function(){
	        	console.log("chatSend text: "+$(".sendText").val());
	        	if($(".sendText").val() === "")
	        	{
	        		alert("请输入要发送的内容!");
	        	}
	        	else
	        	{
	        		var textSend='\
	        		<span>夕阳西下</span>\
	        		<img src="../images/head_bk.jpg">\
	        		<p>'+$(".sendText").val()+'</p>';
					$(".sender").append(textSend);
	        	}
	        })

			

		})//
	</script>

</head>
<body>
<div id="personal">
<!-- <button>close</button> -->
<img src="../images/head_bk.jpg">
<p>帐号：123456</p>
<p>昵称：夕阳西下</p>
<p>星座：双鱼座</p>
<p>故乡：中国</p>
<p>所在地：大陆阿里山</p>
</div>

<div id="panelQQ">
	<div id="panelTop">	
	<img src="../images/head_bk.jpg">
	<span>夕阳西下</span>
	</div>
	<div id="search">
	<input type="text" class="searchText">
	<input type="button" class="addBtn" value="添加">
	</div>
	<div id="group">
	<ul id="groupList">
		<li id="friendList">
			<span>></span>
			<span>好友</span>
			<div class="listInfo">
				<ul>
					<li>
						<input type="checkbox">
						<img src="../images/head_list.jpg">
						<p class="name">熊大</p>
						<button class="del">del</button>
					</li>

					<li>
						<input type="checkbox">
						<img src="../images/head_list.jpg">
						<p class="name">熊二</p>
						<button class="del">del</button>
					</li>

					<li>
						<input type="checkbox">
						<img src="../images/head_list.jpg">
						<p class="name">小熊</p>
						<button class="del">del</button>
					</li>
				</ul>	
			</div>
			
		</li>

		<li>
			<span>></span>
			<span>同学</span>
			<div class="listInfo">
			<ul>
				<li>
					<input type="checkbox">
					<img src="../images/head_list.jpg">
					<p class="name">小郑</p>
					<button class="del">del</button>
				</li>

				<li>
					<input type="checkbox">
					<img src="../images/head_list.jpg">
					<p class="name">小麻</p>
					<button class="del">del</button>
				</li>

				<li>
					<input type="checkbox">
					<img src="../images/head_list.jpg">
					<p class="name">小磊</p>
					<button class="del">del</button>
				</li>
			</ul>	
			</div>
			
		</li>

		<li>
			<span>></span>
			<span>家人</span>
			<div class="listInfo">
				<ul>
					<li>
						<input type="checkbox">
						<img src="../images/head_list.jpg">
						<p class="name">小桃红</p>
						<button class="del">del</button>
					</li>

					<li>
						<input type="checkbox">
						<img src="../images/head_list.jpg">
						<p class="name">小樱子</p>
						<button class="del">del</button>
					</li>

					<li>
						<input type="checkbox">
						<img src="../images/head_list.jpg">
						<p class="name">小英子</p>
						<button class="del">del</button>
					</li>
				</ul>	
			</div>
			
		</li>

		<li>
			<span>></span>
			<span>同事</span>
			<div class="listInfo">
				<ul>
					<li>
						<input type="checkbox">
						<img src="../images/head_list.jpg">
						<p class="name">小李</p>
						<button class="del">del</button>
					</li>

					<li>
						<input type="checkbox">
						<img src="../images/head_list.jpg">
						<p class="name">小高</p>
						<button class="del">del</button>
					</li>

					<li>
						<input type="checkbox">
						<img src="../images/head_list.jpg">
						<p class="name">小陈</p>
						<button class="del">del</button>
					</li>
			</ul>		
			</div>
			
		</li>
	</ul>	
	</div>
	<div id="handle">	
	全选：<input type="checkbox" class="allSel">
	反选：<input type="checkbox" class="invertSel">
	<button class="delSel">选中删除</button>
	</div>

	<div id="option">
	<button>会话</button>
	<button>联系人</button>
	<button>空间</button>
	<button>设置</button>
	</div>	
</div>
<div id="chat">

	<div id="chatTop">
		<p>熊大</p>
		<button>close</button>
	</div>

	<div id="chatMessage">
		<div id="receive">
			<img src="../images/head_list.jpg">
			<span>熊大</span>
			<p>hello</p>
		</div>

		<div class="sender">			
			<span>夕阳西下</span>
			<img src="../images/head_bk.jpg">
			<p>hello</p>
		</div>
		
	</div>

	<div id="chatSend">
		<img src="../images/icon.png">
		<input type="text" class="sendText">
		<button>发  送</button>
	</div>
	
</div>

</body>
</html>