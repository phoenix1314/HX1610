<html>
	<head>
	<script src="/socket.io/socket.io.js" type="text/javascript"></script>
		<script src="jquery-1.8.2.min.js"></script>
		<script>
			function getNowFormatDate() {
				var date = new Date();
				var seperator1 = "-";
				var seperator2 = ":";
				var month = date.getMonth() + 1;
				var strDate = date.getDate();
				if (month >= 1 && month <= 9) {
					month = "0" + month;
				}
				if (strDate >= 0 && strDate <= 9) {
					strDate = "0" + strDate;
				}
				var currentdate = date.getFullYear() + seperator1 + month + seperator1 + strDate
						+ " " + date.getHours() + seperator2 + date.getMinutes()
						+ seperator2 + date.getSeconds();
				return currentdate;
			}
		</script>
		<script type="text/javascript">
			var socket= io("http://127.0.0.1:8888/");
			socket.on("welcomeMsg",function(data){
				//alert(data.info);
				$("#msg").append(data.info);
			})
			socket.on("pushMsg",function(data){
				$("#msg").append("<br/>"+data.from+" say:"+data.msg+" "+data.time);
			})
			socket.on("friendsListEvent",function(data){
				$("#friends").html("");
				for(var i = 0;i < data.nick.length;i++){
//					console.log(data.nick[i]);
					$("#friends").append("<p class='friend'>"+data.nick[i]+"</p>")
				}
				$(".friend").on("click",function(){
					$("#msgto").val( $(this).html());
				})

			})
		</script>
		<script>

			$(function(){

				var nick = prompt("please enter NickName");
				$("#me").html(nick);
				socket.emit("nickEvent",{nickname:nick});

				$("#send").on("click",function(){
					var sendto = $("#msgto").val();
					if(sendto){
						var txt = $("#txt").val();
						var oMsg ={
							msg:txt,
							from:nick,
							to:sendto
						}
						socket.emit("priMsgEvent",oMsg);
					}else{
						var txt = $("#txt").val();
						var oMsg ={
							msg:txt,
							from:nick,

						}
						socket.emit("pubMsgEvent",oMsg);
					}

//					var txt = $("#txt").val();
//					var oMsg ={
//						msg:txt,
//						from:nick,
//						to:"zhangshan"
//
//					}
//                    //组包oMsg 发送给服务器
//					socket.emit("chatMsgEvent",oMsg);
				})
			})
		</script>

	</head>

	<body>
     <p style="font-size: 30px;color: red" id="me"></p>
		sendto:<input id="msgto" type="text" name=""><br/>
		msg<input id="txt" type="text" name=""><br/>
		<button id="send">send</button>
		<div id="friends" style="float:left;border: 1px solid red;width: 200px;height: 700px"></div>
	   <div id="msg" style="float:left;border: 1px solid red;width: 500px;height: 700px"></div>
	</body>
</html>